Environment variable DISPLAY is not present in the system.
Switch the backend of matplotlib to agg.
Load 51 of 2176 image files (st:850, end:901, step:1) in /data/datasets/wenshanw/tartan_data/abandonedfactory/Data/P000/image_left
Load (50, 10) of 21750 IMU frames in /data/datasets/wenshanw/tartan_data/abandonedfactory/Data/P000/imu
Train root: train_results/new_imu-vo-pvgo_lw=(0.01,0.1,10,1)_lr=1e-4_imuscale
Namespace(batch_size=1, worker_num=1, image_width=640, image_height=448, model_name='', flow_model_name='pwc_net.pth.tar', pose_model_name='1_1_sample_voflow_200000.pkl', euroc=False, kitti=False, kitti_intrinsics_file='', test_dir='/data/datasets/wenshanw/tartan_data/abandonedfactory/Data/P000/image_left', pose_file='/data/datasets/wenshanw/tartan_data/abandonedfactory/Data/P000/pose_left.txt', save_flow=False, sample_step=1, start_frame=850, end_frame=900, train_step=20, lr=0.0001, print_interval=1, snapshot_interval=1, train_name='new_imu-vo-pvgo_lw=(0.01,0.1,10,1)_lr=1e-4_imuscale', result_dir='train_results/new_imu-vo-pvgo_lw=(0.01,0.1,10,1)_lr=1e-4_imuscale', only_backpropagate_loop_edge=False, imu_dir='/data/datasets/wenshanw/tartan_data/abandonedfactory/Data/P000/imu', device='cuda:3', use_imu=True, use_pvgo=True, frame_fps=10.0, loss_weight=(0.01, 0.1, 10, 1))
imu preintegration time: 3.5429958200547844
load pwc network...
load pose network...
Model loaded...
Start train step 0 ...
StopOnPlateau on step 0 Loss 2.178430e-03 --> Loss 1.139961e-05 (reduction/loss: 9.9477e-01).
StopOnPlateau on step 1 Loss 1.139961e-05 --> Loss 9.091733e-06 (reduction/loss: 2.0245e-01).
StopOnPlateau on step 2 Loss 9.091733e-06 --> Loss 8.358300e-06 (reduction/loss: 8.0670e-02).
StopOnPlateau on step 3 Loss 8.358300e-06 --> Loss 7.642418e-06 (reduction/loss: 8.5649e-02).
StopOnPlateau: Maximum patience steps reached, Quiting..
new_imu-vo-pvgo_lw=(0.01,0.1,10,1)_lr=1e-4_imuscale #0 - loss:1.016928 - lr:0.000100 - [avgtime] vo:4.89, cvt:0.00, pgo:22.65, opt:2.23
	adj.	loop	tot.
R	0.2541	0.7371	0.4931
t	0.0051	0.0109	0.0079
[time] step: 29.776183806010522, print: 0.0074231980834156275, snapshot: 0.007728127995505929
Start train step 1 ...
StopOnPlateau on step 0 Loss 1.596296e-03 --> Loss 7.075336e-06 (reduction/loss: 9.9557e-01).
StopOnPlateau on step 1 Loss 7.075336e-06 --> Loss 5.946292e-06 (reduction/loss: 1.5957e-01).
StopOnPlateau on step 2 Loss 5.946292e-06 --> Loss 5.497088e-06 (reduction/loss: 7.5543e-02).
StopOnPlateau on step 3 Loss 5.497088e-06 --> Loss 5.042122e-06 (reduction/loss: 8.2765e-02).
StopOnPlateau: Maximum patience steps reached, Quiting..
new_imu-vo-pvgo_lw=(0.01,0.1,10,1)_lr=1e-4_imuscale #1 - loss:1.013089 - lr:0.000100 - [avgtime] vo:3.44, cvt:0.00, pgo:22.76, opt:2.23
	adj.	loop	tot.
R	0.1566	0.4540	0.3038
t	0.0041	0.0083	0.0062
[time] step: 28.43758947297465, print: 0.010457411990500987, snapshot: 0.00776791397947818
Start train step 2 ...
StopOnPlateau on step 0 Loss 1.316117e-03 --> Loss 6.419429e-06 (reduction/loss: 9.9512e-01).
StopOnPlateau on step 1 Loss 6.419429e-06 --> Loss 5.289453e-06 (reduction/loss: 1.7602e-01).
StopOnPlateau on step 2 Loss 5.289453e-06 --> Loss 4.813210e-06 (reduction/loss: 9.0036e-02).
StopOnPlateau on step 3 Loss 4.813210e-06 --> Loss 4.381817e-06 (reduction/loss: 8.9627e-02).
StopOnPlateau: Maximum patience steps reached, Quiting..
new_imu-vo-pvgo_lw=(0.01,0.1,10,1)_lr=1e-4_imuscale #2 - loss:1.012185 - lr:0.000100 - [avgtime] vo:3.74, cvt:0.00, pgo:21.90, opt:2.18
	adj.	loop	tot.
R	0.1610	0.2909	0.2253
t	0.0041	0.0081	0.0061
[time] step: 27.815731314010918, print: 0.01584840298164636, snapshot: 0.007990897982381284
Start train step 3 ...
StopOnPlateau on step 0 Loss 9.004598e-04 --> Loss 5.972474e-06 (reduction/loss: 9.9337e-01).
StopOnPlateau on step 1 Loss 5.972474e-06 --> Loss 5.101549e-06 (reduction/loss: 1.4582e-01).
StopOnPlateau on step 2 Loss 5.101549e-06 --> Loss 4.688620e-06 (reduction/loss: 8.0942e-02).
StopOnPlateau: Maximum patience steps reached, Quiting..
new_imu-vo-pvgo_lw=(0.01,0.1,10,1)_lr=1e-4_imuscale #3 - loss:1.011408 - lr:0.000100 - [avgtime] vo:4.64, cvt:0.00, pgo:16.70, opt:2.25
	adj.	loop	tot.
R	0.1864	0.2378	0.2118
t	0.0039	0.0077	0.0058
[time] step: 23.59778184304014, print: 0.01735552097670734, snapshot: 0.008076532045379281
Start train step 4 ...
StopOnPlateau on step 0 Loss 8.733780e-04 --> Loss 6.170495e-06 (reduction/loss: 9.9293e-01).
StopOnPlateau on step 1 Loss 6.170495e-06 --> Loss 5.532781e-06 (reduction/loss: 1.0335e-01).
StopOnPlateau on step 2 Loss 5.532781e-06 --> Loss 5.147020e-06 (reduction/loss: 6.9723e-02).
StopOnPlateau: Maximum patience steps reached, Quiting..
new_imu-vo-pvgo_lw=(0.01,0.1,10,1)_lr=1e-4_imuscale #4 - loss:1.010458 - lr:0.000100 - [avgtime] vo:4.53, cvt:0.00, pgo:17.88, opt:2.38
	adj.	loop	tot.
R	0.1959	0.2078	0.2018
t	0.0037	0.0071	0.0054
[time] step: 24.793652098975144, print: 0.04164493002463132, snapshot: 0.00760017498396337
Start train step 5 ...
StopOnPlateau on step 0 Loss 7.707351e-04 --> Loss 6.927544e-06 (reduction/loss: 9.9101e-01).
StopOnPlateau on step 1 Loss 6.927544e-06 --> Loss 6.346483e-06 (reduction/loss: 8.3877e-02).
StopOnPlateau on step 2 Loss 6.346483e-06 --> Loss 5.929002e-06 (reduction/loss: 6.5781e-02).
StopOnPlateau: Maximum patience steps reached, Quiting..
new_imu-vo-pvgo_lw=(0.01,0.1,10,1)_lr=1e-4_imuscale #5 - loss:1.009612 - lr:0.000100 - [avgtime] vo:4.72, cvt:0.00, pgo:17.26, opt:2.33
	adj.	loop	tot.
R	0.1781	0.1833	0.1807
t	0.0036	0.0072	0.0054
[time] step: 24.301861276035197, print: 0.041641972959041595, snapshot: 0.007443286012858152
Start train step 6 ...
StopOnPlateau on step 0 Loss 7.512950e-04 --> Loss 7.858489e-06 (reduction/loss: 9.8954e-01).
StopOnPlateau on step 1 Loss 7.858489e-06 --> Loss 7.218095e-06 (reduction/loss: 8.1491e-02).
StopOnPlateau on step 2 Loss 7.218095e-06 --> Loss 6.724225e-06 (reduction/loss: 6.8421e-02).
StopOnPlateau: Maximum patience steps reached, Quiting..
new_imu-vo-pvgo_lw=(0.01,0.1,10,1)_lr=1e-4_imuscale #6 - loss:1.009184 - lr:0.000100 - [avgtime] vo:4.65, cvt:0.00, pgo:17.94, opt:2.36
	adj.	loop	tot.
R	0.1564	0.1900	0.1730
t	0.0040	0.0082	0.0061
[time] step: 24.951216708985157, print: 0.027088155038654804, snapshot: 0.006213966989889741
Start train step 7 ...
StopOnPlateau on step 0 Loss 7.118243e-04 --> Loss 8.146835e-06 (reduction/loss: 9.8855e-01).
StopOnPlateau on step 1 Loss 8.146835e-06 --> Loss 7.567197e-06 (reduction/loss: 7.1149e-02).
StopOnPlateau on step 2 Loss 7.567197e-06 --> Loss 7.050229e-06 (reduction/loss: 6.8317e-02).
StopOnPlateau: Maximum patience steps reached, Quiting..
new_imu-vo-pvgo_lw=(0.01,0.1,10,1)_lr=1e-4_imuscale #7 - loss:1.008652 - lr:0.000100 - [avgtime] vo:4.65, cvt:0.00, pgo:17.72, opt:2.25
	adj.	loop	tot.
R	0.1284	0.1974	0.1625
t	0.0046	0.0092	0.0069
[time] step: 24.631980853970163, print: 0.020996149978600442, snapshot: 0.008220494957640767
Start train step 8 ...
StopOnPlateau on step 0 Loss 6.842104e-04 --> Loss 7.937193e-06 (reduction/loss: 9.8840e-01).
StopOnPlateau on step 1 Loss 7.937193e-06 --> Loss 7.463540e-06 (reduction/loss: 5.9675e-02).
StopOnPlateau on step 2 Loss 7.463540e-06 --> Loss 6.965970e-06 (reduction/loss: 6.6667e-02).
StopOnPlateau: Maximum patience steps reached, Quiting..
new_imu-vo-pvgo_lw=(0.01,0.1,10,1)_lr=1e-4_imuscale #8 - loss:1.008212 - lr:0.000100 - [avgtime] vo:4.47, cvt:0.00, pgo:17.88, opt:2.38
	adj.	loop	tot.
R	0.1029	0.2039	0.1529
t	0.0051	0.0100	0.0075
[time] step: 24.733436396927573, print: 0.03953440301120281, snapshot: 0.006433414062485099
Start train step 9 ...
StopOnPlateau on step 0 Loss 6.634795e-04 --> Loss 7.613992e-06 (reduction/loss: 9.8852e-01).
StopOnPlateau on step 1 Loss 7.613992e-06 --> Loss 7.177439e-06 (reduction/loss: 5.7336e-02).
StopOnPlateau on step 2 Loss 7.177439e-06 --> Loss 6.701807e-06 (reduction/loss: 6.6268e-02).
StopOnPlateau: Maximum patience steps reached, Quiting..
new_imu-vo-pvgo_lw=(0.01,0.1,10,1)_lr=1e-4_imuscale #9 - loss:1.008087 - lr:0.000100 - [avgtime] vo:4.90, cvt:0.00, pgo:17.89, opt:2.40
	adj.	loop	tot.
R	0.0900	0.2100	0.1494
t	0.0054	0.0106	0.0080
[time] step: 25.19200689403806, print: 0.039032367058098316, snapshot: 0.007135669933632016
Start train step 10 ...
StopOnPlateau on step 0 Loss 6.491091e-04 --> Loss 7.568006e-06 (reduction/loss: 9.8834e-01).
StopOnPlateau on step 1 Loss 7.568006e-06 --> Loss 7.107126e-06 (reduction/loss: 6.0898e-02).
StopOnPlateau on step 2 Loss 7.107126e-06 --> Loss 6.620214e-06 (reduction/loss: 6.8510e-02).
StopOnPlateau: Maximum patience steps reached, Quiting..
new_imu-vo-pvgo_lw=(0.01,0.1,10,1)_lr=1e-4_imuscale #10 - loss:1.007931 - lr:0.000100 - [avgtime] vo:4.67, cvt:0.00, pgo:17.73, opt:2.33
	adj.	loop	tot.
R	0.0949	0.1901	0.1420
t	0.0057	0.0111	0.0084
[time] step: 24.73631761991419, print: 0.028347091050818563, snapshot: 0.007794704986736178
Start train step 11 ...
StopOnPlateau on step 0 Loss 6.403591e-04 --> Loss 7.603814e-06 (reduction/loss: 9.8813e-01).
StopOnPlateau on step 1 Loss 7.603814e-06 --> Loss 7.118769e-06 (reduction/loss: 6.3790e-02).
StopOnPlateau on step 2 Loss 7.118769e-06 --> Loss 6.610307e-06 (reduction/loss: 7.1426e-02).
StopOnPlateau: Maximum patience steps reached, Quiting..
new_imu-vo-pvgo_lw=(0.01,0.1,10,1)_lr=1e-4_imuscale #11 - loss:1.007450 - lr:0.000100 - [avgtime] vo:4.87, cvt:0.00, pgo:18.03, opt:2.40
	adj.	loop	tot.
R	0.1052	0.1546	0.1296
t	0.0059	0.0115	0.0087
[time] step: 25.302579948911443, print: 0.035613039042800665, snapshot: 0.025781377917155623
Start train step 12 ...
StopOnPlateau on step 0 Loss 6.280147e-04 --> Loss 7.610405e-06 (reduction/loss: 9.8788e-01).
StopOnPlateau on step 1 Loss 7.610405e-06 --> Loss 7.136721e-06 (reduction/loss: 6.2242e-02).
StopOnPlateau on step 2 Loss 7.136721e-06 --> Loss 6.617258e-06 (reduction/loss: 7.2787e-02).
StopOnPlateau: Maximum patience steps reached, Quiting..
new_imu-vo-pvgo_lw=(0.01,0.1,10,1)_lr=1e-4_imuscale #12 - loss:1.006999 - lr:0.000100 - [avgtime] vo:4.88, cvt:0.00, pgo:17.91, opt:2.41
	adj.	loop	tot.
R	0.1151	0.1359	0.1254
t	0.0061	0.0117	0.0089
[time] step: 25.20969858497847, print: 0.03751032997388393, snapshot: 0.007474565994925797
Start train step 13 ...
StopOnPlateau on step 0 Loss 6.092945e-04 --> Loss 7.430268e-06 (reduction/loss: 9.8781e-01).
StopOnPlateau on step 1 Loss 7.430268e-06 --> Loss 6.993869e-06 (reduction/loss: 5.8733e-02).
StopOnPlateau on step 2 Loss 6.993869e-06 --> Loss 6.489612e-06 (reduction/loss: 7.2100e-02).
StopOnPlateau: Maximum patience steps reached, Quiting..
new_imu-vo-pvgo_lw=(0.01,0.1,10,1)_lr=1e-4_imuscale #13 - loss:1.006739 - lr:0.000100 - [avgtime] vo:4.97, cvt:0.00, pgo:17.94, opt:2.40
	adj.	loop	tot.
R	0.1136	0.1423	0.1278
t	0.0063	0.0119	0.0091
[time] step: 25.319413826917298, print: 0.038166359066963196, snapshot: 0.025884193019010127
Start train step 14 ...
StopOnPlateau on step 0 Loss 5.740518e-04 --> Loss 6.971459e-06 (reduction/loss: 9.8786e-01).
StopOnPlateau on step 1 Loss 6.971459e-06 --> Loss 6.582331e-06 (reduction/loss: 5.5817e-02).
StopOnPlateau on step 2 Loss 6.582331e-06 --> Loss 6.122381e-06 (reduction/loss: 6.9876e-02).
StopOnPlateau: Maximum patience steps reached, Quiting..
new_imu-vo-pvgo_lw=(0.01,0.1,10,1)_lr=1e-4_imuscale #14 - loss:1.006597 - lr:0.000100 - [avgtime] vo:4.24, cvt:0.00, pgo:17.94, opt:2.36
	adj.	loop	tot.
R	0.1033	0.1468	0.1249
t	0.0065	0.0122	0.0093
[time] step: 24.549742617062293, print: 0.027250734041444957, snapshot: 0.027116458979435265
Start train step 15 ...
StopOnPlateau on step 0 Loss 5.459435e-04 --> Loss 6.406433e-06 (reduction/loss: 9.8827e-01).
StopOnPlateau on step 1 Loss 6.406433e-06 --> Loss 6.048205e-06 (reduction/loss: 5.5917e-02).
StopOnPlateau on step 2 Loss 6.048205e-06 --> Loss 5.638194e-06 (reduction/loss: 6.7791e-02).
StopOnPlateau: Maximum patience steps reached, Quiting..
new_imu-vo-pvgo_lw=(0.01,0.1,10,1)_lr=1e-4_imuscale #15 - loss:1.006913 - lr:0.000100 - [avgtime] vo:4.16, cvt:0.00, pgo:17.95, opt:2.38
	adj.	loop	tot.
R	0.1015	0.1627	0.1318
t	0.0068	0.0127	0.0097
[time] step: 24.49247021600604, print: 0.03469763696193695, snapshot: 0.026525554014369845
Start train step 16 ...
StopOnPlateau on step 0 Loss 5.194330e-04 --> Loss 5.864596e-06 (reduction/loss: 9.8871e-01).
StopOnPlateau on step 1 Loss 5.864596e-06 --> Loss 5.490154e-06 (reduction/loss: 6.3848e-02).
StopOnPlateau on step 2 Loss 5.490154e-06 --> Loss 5.116210e-06 (reduction/loss: 6.8112e-02).
StopOnPlateau: Maximum patience steps reached, Quiting..
new_imu-vo-pvgo_lw=(0.01,0.1,10,1)_lr=1e-4_imuscale #16 - loss:1.007305 - lr:0.000100 - [avgtime] vo:4.89, cvt:0.01, pgo:17.97, opt:2.43
	adj.	loop	tot.
R	0.1019	0.1721	0.1367
t	0.0070	0.0131	0.0100
[time] step: 25.289928280049935, print: 0.031060895998962224, snapshot: 0.006799800903536379
Start train step 17 ...
StopOnPlateau on step 0 Loss 5.172000e-04 --> Loss 5.398107e-06 (reduction/loss: 9.8956e-01).
StopOnPlateau on step 1 Loss 5.398107e-06 --> Loss 4.966149e-06 (reduction/loss: 8.0020e-02).
StopOnPlateau on step 2 Loss 4.966149e-06 --> Loss 4.612394e-06 (reduction/loss: 7.1233e-02).
StopOnPlateau: Maximum patience steps reached, Quiting..
new_imu-vo-pvgo_lw=(0.01,0.1,10,1)_lr=1e-4_imuscale #17 - loss:1.007624 - lr:0.000100 - [avgtime] vo:4.41, cvt:0.00, pgo:17.95, opt:2.43
	adj.	loop	tot.
R	0.0997	0.1626	0.1308
t	0.0073	0.0135	0.0104
[time] step: 24.79363585799001, print: 0.03935841703787446, snapshot: 0.0068510789424180984
Start train step 18 ...
StopOnPlateau on step 0 Loss 5.503476e-04 --> Loss 5.042903e-06 (reduction/loss: 9.9084e-01).
StopOnPlateau on step 1 Loss 5.042903e-06 --> Loss 4.544017e-06 (reduction/loss: 9.8928e-02).
StopOnPlateau on step 2 Loss 4.544017e-06 --> Loss 4.196502e-06 (reduction/loss: 7.6477e-02).
StopOnPlateau: Maximum patience steps reached, Quiting..
new_imu-vo-pvgo_lw=(0.01,0.1,10,1)_lr=1e-4_imuscale #18 - loss:1.007705 - lr:0.000100 - [avgtime] vo:4.60, cvt:0.00, pgo:17.96, opt:2.42
	adj.	loop	tot.
R	0.0944	0.1510	0.1224
t	0.0077	0.0138	0.0107
[time] step: 24.978125010966323, print: 0.03622140898369253, snapshot: 0.007722879061475396
Start train step 19 ...
StopOnPlateau on step 0 Loss 5.809219e-04 --> Loss 4.683425e-06 (reduction/loss: 9.9194e-01).
StopOnPlateau on step 1 Loss 4.683425e-06 --> Loss 4.166290e-06 (reduction/loss: 1.1042e-01).
StopOnPlateau on step 2 Loss 4.166290e-06 --> Loss 3.838162e-06 (reduction/loss: 7.8758e-02).
StopOnPlateau: Maximum patience steps reached, Quiting..
new_imu-vo-pvgo_lw=(0.01,0.1,10,1)_lr=1e-4_imuscale #19 - loss:1.007835 - lr:0.000100 - [avgtime] vo:4.77, cvt:0.00, pgo:17.87, opt:2.38
	adj.	loop	tot.
R	0.0996	0.1489	0.1240
t	0.0079	0.0142	0.0110
[time] step: 25.02070375904441, print: 0.03364570706617087, snapshot: 0.006895954953506589
